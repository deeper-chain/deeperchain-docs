{
    "componentChunkName": "component---src-templates-kb-template-tsx",
    "path": "/v3/tools/memory-profiling/",
    "result": {"data":{"mdx":{"frontmatter":{"slug":"/v3/tools/memory-profiling","title":"Memory Profiling","hideNav":null,"section":"docs","category":"tools"},"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Memory Profiling\",\n  \"slug\": \"/v3/tools/memory-profiling\",\n  \"version\": 3,\n  \"section\": \"docs\",\n  \"category\": \"tools\",\n  \"keywords\": null\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Memory profiling enables you to understand the memory allocation and behavior of your blockchain\\napplications over time in Substrate-based clients. It identifies method calls in the context of how\\nmemory was allocated, combining this information with the number of allocated objects. In addition,\\nprofiling can be used to analyze memory leaks, identify where memory consumption is happening,\\ndefine temporary allocations, and investigate excessive memory fragmentation within applications.\"), mdx(\"p\", null, \"The profiler we recommend is \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/koute/memory-profiler\"\n  }, \"koute's memory profiler\"), \".\"), mdx(\"h2\", {\n    \"id\": \"installation\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#installation\",\n    \"aria-label\": \"installation permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Installation\"), mdx(\"h3\", {\n    \"id\": \"from-a-binary-release\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#from-a-binary-release\",\n    \"aria-label\": \"from a binary release permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"From a binary release\"), mdx(\"p\", null, \"You can download a precompiled binary release of the profiler from \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/koute/memory-profiler/releases\"\n  }, \"here\"), \".\\nThe last version we've tested is 0.6.1, but any newer one will also most likely work.\"), mdx(\"p\", null, \"Here's how you can download and unpack it from the command-line:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ curl -L https://github.com/koute/memory-profiler/releases/download/0.6.1/memory-profiler-x86_64-unknown-linux-gnu.tgz -o memory-profiler-x86_64-unknown-linux-gnu.tgz\\n$ tar -xf memory-profiler-x86_64-unknown-linux-gnu.tgz\\n\")), mdx(\"p\", null, \"This will result in three files being unpacked. We're only interested in two of them:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"libmemory_profiler.so\"), \" - this is the memory profiler itself that we will hook into Substrate\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"memory-profiler-cli\"), \" - this is the program we will later use to analyze the profiling data\")), mdx(\"h3\", {\n    \"id\": \"from-source\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#from-source\",\n    \"aria-label\": \"from source permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"From source\"), mdx(\"p\", null, \"You can also \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/koute/memory-profiler#building\"\n  }, \"compile the profiler from source\"), \" yourself.\"), mdx(\"p\", null, \"First you need to make sure to have the following installed:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"GCC toolchain\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Rust nightly (we've tested version \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \"nightly-2021-06-08\"), \")\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", {\n    parentName: \"li\",\n    \"href\": \"https://yarnpkg.com\"\n  }, \"Yarn\"), \" package manager (for building the GUI)\")), mdx(\"p\", null, \"Then you should be able to build the profiler like this:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ git clone https://github.com/koute/memory-profiler\\n$ cd memory-profiler\\n$ cargo build --release -p memory-profiler\\n$ cargo build --release -p memory-profiler-cli\\n\")), mdx(\"p\", null, \"You'll find the binaries we need in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"target/release/libmemory_profiler.so\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"target/release/memory-profiler-cli\"), \".\"), mdx(\"h2\", {\n    \"id\": \"hooking-up-the-profiler-to-substrate\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#hooking-up-the-profiler-to-substrate\",\n    \"aria-label\": \"hooking up the profiler to substrate permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Hooking up the profiler to Substrate\"), mdx(\"p\", null, \"This part heavily depends on how exactly you're launching Substrate.\"), mdx(\"h3\", {\n    \"id\": \"hooking-to-a-manually-launched-substrate\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#hooking-to-a-manually-launched-substrate\",\n    \"aria-label\": \"hooking to a manually launched substrate permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Hooking to a manually launched Substrate\"), mdx(\"p\", null, \"If you're manually launching Substrate from the command-line then hooking the profiler up to it\\nboils down to just setting up a few extra environment variables and then launching it normally as\\nyou'd usually do.\"), mdx(\"p\", null, \"First, we want to enable logging, tell the profiler where it's supposed to output its logs, where it\\nshould gather its profiling data, and optionally tell it to cull temporary allocations:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ export MEMORY_PROFILER_LOG=info\\n$ export MEMORY_PROFILER_LOGFILE=profiling_%e_%t.log\\n$ export MEMORY_PROFILER_OUTPUT=profiling_%e_%t.dat\\n\\n# Optional, depending on what exact aspect you'd like to profile\\n# and how long you're going to be profiling.\\n$ export MEMORY_PROFILER_CULL_TEMPORARY_ALLOCATIONS=1\\n\")), mdx(\"p\", null, \"Then we can launch Substrate with the profiler attached:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ LD_PRELOAD=/path/to/libmemory_profiler.so ./target/release/substrate\\n\")), mdx(\"p\", null, \"Setting the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"LD_PRELOAD\"), \" environment variable will instruct Linux's dynamic linker to inject the\\nmemory profiler into Substrate just before it's launched, which allows the profiler to hook into the\\nsystem's memory allocation routines and track every memory allocation that Substrate's doing.\"), mdx(\"h3\", {\n    \"id\": \"hooking-to-substrate-launched-through-systemd\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#hooking-to-substrate-launched-through-systemd\",\n    \"aria-label\": \"hooking to substrate launched through systemd permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Hooking to Substrate launched through \", mdx(\"inlineCode\", {\n    parentName: \"h3\"\n  }, \"systemd\")), mdx(\"p\", null, \"If you're running a Substrate-based node remotely you're probably using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"systemd\"), \" to manage it.\\nHere's how you could go about setting up profiling in such a situation.\"), mdx(\"p\", null, \"We assume you've already either downloaded a precompiled binary of the profiler or compiled it from\\nsource, and you have it in your current directory.\"), mdx(\"p\", null, \"First, we want to copy the memory profiler to a globally accessible location and set up a place\\nwhere it can write its logs and gather the profiling data.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ sudo mkdir -p /opt/memory-profiler/bin\\n$ sudo cp libmemory_profiler.so /opt/memory-profiler/bin/\\n$ sudo mkdir /opt/memory-profiler/logs\\n$ sudo chmod 0777 /opt/memory-profiler/logs\\n\")), mdx(\"p\", null, \"Then we want to set up a file with all of the environment variables to configure the profiler itself:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ echo \\\"MEMORY_PROFILER_OUTPUT=/opt/memory-profiler/logs/profiling_%e_%t_%p.dat\\\" | sudo tee /opt/memory-profiler/env\\n$ echo \\\"MEMORY_PROFILER_LOGFILE=/opt/memory-profiler/logs/profiling_%e_%t_%p.txt\\\" | sudo tee -a /opt/memory-profiler/env\\n$ echo \\\"MEMORY_PROFILER_LOG=info\\\" | sudo tee -a /opt/memory-profiler/env\\n$ echo \\\"MEMORY_PROFILER_CULL_TEMPORARY_ALLOCATIONS=1\\\" | sudo tee -a /opt/memory-profiler/env\\n$ echo \\\"LD_PRELOAD=/opt/memory-profiler/bin/libmemory_profiler.so\\\" | sudo tee -a /opt/memory-profiler/env\\n\")), mdx(\"p\", null, \"Now you want to open your \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"systemd\"), \" unit file for your node and add the following in the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[Service]\"), \" section:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"[Service]\\nEnvironmentFile=/opt/memory-profiler/env\\n\")), mdx(\"p\", null, \"Do not add another \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"[Service]\"), \" section if one already exists; just add the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"EnvironmentFile\"), \" key to it.\\nIf you already have one \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"EnvironmentFile\"), \" key do not replace it; just add a second one, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"systemd\"), \" will apply both.\"), mdx(\"p\", null, \"Now you can reload your \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"systemd\"), \" daemon:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ sudo systemctl daemon-reload\\n\")), mdx(\"p\", null, \"And then restart your service to start the profiling:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ sudo systemctl restart kusama\\n\")), mdx(\"p\", null, \"The profiling data will be gathered at \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/opt/memory-profiler/logs\"), \". If you want to disable the\\nmemory profiler just delete the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"EnvironmentFile\"), \" key you've added to your unit file, and restart\\nthe service again.\"), mdx(\"h3\", {\n    \"id\": \"configuring-the-profiler\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#configuring-the-profiler\",\n    \"aria-label\": \"configuring the profiler permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Configuring the profiler\"), mdx(\"p\", null, \"There are also \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/koute/memory-profiler#environment-variables-used-by-libmemory_profilerso\"\n  }, \"other environment variables you can set to configure the profiler\"), \",\\nalthough besides the ones we've already shown changing them shouldn't be necessary in normal circumstances.\"), mdx(\"p\", null, \"One configuration knob that warrants extra consideration is \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MEMORY_PROFILER_CULL_TEMPORARY_ALLOCATIONS\"), \",\\nwhich controls whenever the profiler will gather short lived allocations.\"), mdx(\"p\", null, \"By default the profiler will gather \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"every\"), \" allocation that's made by the profiled application.\\nThat is a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"lot\"), \" of data, and can be on the order of \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"megabytes\"), \" per second. This is great if you\\nwant to only profile for a short period of time, or if you specifically care about diagnosing\\ntemporary allocations, but it becomes problematic when you want to leave the profiler running for\\nlonger.\"), mdx(\"p\", null, \"This is where the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"MEMORY_PROFILER_CULL_TEMPORARY_ALLOCATIONS\"), \" option comes in. When you turn it on\\nby setting it to \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"1\"), \" the profiler will omit all of the really short lived allocations and not write\\nthem out to disk. This significantly cuts down the amount of data that's generated, usually to the\\nrange of \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"kilobytes\"), \" per second, which makes it possible to leave the profiling running for days at\\na time.\"), mdx(\"h2\", {\n    \"id\": \"analysis\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#analysis\",\n    \"aria-label\": \"analysis permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Analysis\"), mdx(\"p\", null, \"Now that you've gathered the profiling data you can now analyze it.\"), mdx(\"p\", null, \"Assuming you have both the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"memory-profiler-cli\"), \" and the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".dat\"), \" file you've gathered\\nin the same directory you can load the GUI for it:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ ./memory-profiler-cli server *.dat\\n\")), mdx(\"p\", null, \"This might take a while, depending or your exact hardware and on the amount of data you're trying to load.\\nEventually you should see something like this being printed out:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"[2020-05-06T08:59:20Z INFO \\xA0cli_core::loader] Loaded data in 315s 820\\n[2020-05-06T08:59:20Z INFO \\xA0actix_server::builder] Starting 8 workers\\n[2020-05-06T08:59:20Z INFO \\xA0actix_server::builder] Starting server on 127.0.0.1:8080\\n\")), mdx(\"p\", null, \"Now you can open your web browser and access the GUI at \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://localhost:8080/\"), \".\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"46.333333333333336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA5UlEQVQoz5WP246DMAxE8//fx7607K0SJdAE7CAucWxnBah52wdGR9Yo45EVw6KI+Ho5RAwhzPNMRCLCzPSW/COzLEvTNDCOOWu+KDOtqZ0ENo18vTxH+R7TA3mK18uiunGOnOXoas7Luq5bjJQKlFJKXL6lqiKiIuYwnETKXWE+Mt1RZU4b7RAz8b4ZU5q3bSEyRPTlh7tzbQg2hGcIz2lqQmgQHwC/AD/e197fj1kPQ32Ym3Of3ptpXT+67qQ6sbYqvu8r2x5pX9ZObs4ZYu4AOsR9npwe0QLY/WW04/j2UKIO4A/ZdAauTvmo1AAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Graphs from the web UI\",\n    \"title\": \"Graphs from the web UI\",\n    \"src\": \"/static/b64fd97351b25ea5beea39afd6b726bf/c1b63/mem-profiling-memory-graph.png\",\n    \"srcSet\": [\"/static/b64fd97351b25ea5beea39afd6b726bf/5a46d/mem-profiling-memory-graph.png 300w\", \"/static/b64fd97351b25ea5beea39afd6b726bf/0a47e/mem-profiling-memory-graph.png 600w\", \"/static/b64fd97351b25ea5beea39afd6b726bf/c1b63/mem-profiling-memory-graph.png 1200w\", \"/static/b64fd97351b25ea5beea39afd6b726bf/d61c2/mem-profiling-memory-graph.png 1800w\", \"/static/b64fd97351b25ea5beea39afd6b726bf/9efb3/mem-profiling-memory-graph.png 1894w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, \"There's also \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/koute/memory-profiler#rest-api-exposed-by-memory-profiler-cli-server\"\n  }, \"a REST API\"), \"\\nthat you can access you'd like to export the data into another format or inspect it programmatically.\"), mdx(\"h2\", {\n    \"id\": \"miscellaneous-tips\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#miscellaneous-tips\",\n    \"aria-label\": \"miscellaneous tips permalink\",\n    \"className\": \"anchor before\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"className\": \"fill-current text-substrateDark dark:text-white\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  }))), \"Miscellaneous tips\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"It's a good idea to always check the logs generated by the profiler and see whenever there are any\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"WRN\"), \" or \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ERR\"), \" logs present.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"You might see the the following error or warning in the profiler's logs depending on which Linux\\ndistribution you're running:\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"The perf_event_open syscall failed for PID 0: Operation not permitted (os error 1)`\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"This is generally harmless; at most this should only result in higher CPU usage when profiling.\\nYou can avoid it by doing something like this:\"), mdx(\"pre\", {\n    parentName: \"li\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"$ echo \\\"-1\\\" | sudo tee /proc/sys/kernel/perf_event_paranoid\\n\")), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Although please note that this might have some security implications. Take a look at\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"man perf_event_open\"), \" for more details.\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"During analysis the whole data file has to be loaded into memory. If you don't have enough RAM\\nand you'll try to load up a big file the analyzer might run out of memory and crash.\"))));\n}\n;\nMDXContent.isMDXComponent = true;","tableOfContents":{"items":[{"url":"#installation","title":"Installation","items":[{"url":"#from-a-binary-release","title":"From a binary release"},{"url":"#from-source","title":"From source"}]},{"url":"#hooking-up-the-profiler-to-substrate","title":"Hooking up the profiler to Substrate","items":[{"url":"#hooking-to-a-manually-launched-substrate","title":"Hooking to a manually launched Substrate"},{"url":"#hooking-to-substrate-launched-through-systemd","title":"Hooking to Substrate launched through systemd"},{"url":"#configuring-the-profiler","title":"Configuring the profiler"}]},{"url":"#analysis","title":"Analysis"},{"url":"#miscellaneous-tips","title":"Miscellaneous tips"}]},"fileAbsolutePath":"/Users/a212/Desktop/substrate-docs/v3/docs/06-tools/b-memory-profiling/index.mdx"}},"pageContext":{"slug":"/v3/tools/memory-profiling","version":"3.0","locale":"en","hrefLang":"en-US","originalPath":"/v3/tools/memory-profiling/","dateFormat":"MM/DD/YYYY"}},
    "staticQueryHashes": ["1239077767","1821483254","2966362950","3280999885"]}